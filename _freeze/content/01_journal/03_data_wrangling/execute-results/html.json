{
  "hash": "1976205e8892396d7a2349a4dc242b15",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Corinna Boenke\"\n---\n\n\n# Challenge 3\n\n## Load librarys\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-1_b98ad99f23b102de6af5f8f3ac478770'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(eval = FALSE)\n\nlibrary(conflicted)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.2     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.1\n```\n:::\n\n```{.r .cell-code}\nlibrary(vroom)\nlibrary(data.table)\nlibrary(furrr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Lade nötiges Paket: future\n```\n:::\n\n```{.r .cell-code}\nlibrary(tictoc)\nlibrary(readxl)\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\nconflicts_prefer(vroom::col_character)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> [conflicted] Will prefer vroom::col_character over any other package.\n```\n:::\n\n```{.r .cell-code}\nconflicts_prefer(vroom::col_date)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> [conflicted] Will prefer vroom::col_date over any other package.\n```\n:::\n\n```{.r .cell-code}\nconflicts_prefer(vroom::col_double)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> [conflicted] Will prefer vroom::col_double over any other package.\n```\n:::\n:::\n\n## Get Data\n\n::: {.cell hash='03_data_wrangling_cache/html/exercise_35a4600a3572a9827156814bdb4bca79'}\n\n```{.r .cell-code}\nassignee_col_types <- list(\n  id = col_character(),\n  type = col_character(),\n  name_first = col_character(),\n  name_last = col_character(),\n  organization = col_character()\n)\n\nassignee_tbl <- vroom(\n  file       = \"assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = assignee_col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\nassignee_clean_tbl <- assignee_tbl %>%\n  as_tibble() %>%\n  rename(assignee_id = id) %>%\n  select(assignee_id, type, organization)\n\nsetDT(assignee_clean_tbl)\nclass(assignee_clean_tbl)\n\npatent_assignee_col_types <- list(\n  patent_id = col_character(),\n  assignee_id = col_character(),\n  location_id = col_character()\n)\n\npatent_assignee_tbl <- vroom(\n  file       = \"patent_assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = patent_assignee_col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\n\npatent_assignee_clean_tbl <- patent_assignee_tbl %>%\n  as_tibble() %>%\n  select(assignee_id, patent_id)\n\nsetDT(patent_assignee_clean_tbl)\nclass(patent_assignee_clean_tbl)\n\n\ncombined_data_1_tbl <- merge(x = patent_assignee_clean_tbl, y = assignee_clean_tbl, \n                             by    = \"assignee_id\", \n                             all.x = TRUE, \n                             all.y = FALSE)\n\n\ncombined_data_1_cleaned_tbl <- combined_data_1_tbl %>%\n  select(patent_id, type, organization)\n\nsaveRDS(combined_data_1_cleaned_tbl, \"patent_1_cleaned_data_tbl.rds\")\n\nuspc_col_types <- list(\n  uuid = col_character(),\n  patent_id = col_character(),\n  mainclass_id = col_character(),\n  subclass_id = col_character(),\n  sequence = col_character()\n)\n\n\nuspc_tbl <- vroom(\n  file       = \"uspc.tsv\", \n  delim      = \"\\t\", \n  col_types  = uspc_col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\n\nuspc_clean_tbl <- uspc_tbl %>%\n  as_tibble() %>%\n  select(patent_id, mainclass_id)\n\nsetDT(uspc_clean_tbl)\nclass(uspc_clean_tbl)\n\n\n\ncombined_data_2_tbl <- merge(x = uspc_clean_tbl, y = combined_data_1_cleaned_tbl, \n                             by    = \"patent_id\", \n                             all.x = TRUE, \n                             all.y = FALSE)\n\ncombined_data_2_cleaned_tbl <- combined_data_2_tbl %>%\n  select(patent_id, type, organization,mainclass_id)\n\nsaveRDS(combined_data_2_cleaned_tbl, \"patent_2_cleaned_data_tbl.rds\")\n\ncol_types <- list(\n  id = col_character(),\n  type = col_character(),\n  number = col_character(),\n  country = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  month = col_character(),\n  abstract = col_character(),\n  title = col_character(),\n  kind = col_character(),\n  num_claims = col_double(),\n  filename = col_character(),\n  withdrawn = col_double()\n)\n\npatent_tbl <- vroom(\n  file       = \"patent.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\npatent_clean_tbl <- patent_tbl %>%\n  as_tibble() %>%\n  rename(patent_id = id) %>%\n  select(patent_id, date)\n\nsetDT(patent_clean_tbl)\nclass(patent_clean_tbl)\n\n\ncombined_data_3_tbl <- merge(x = patent_clean_tbl, y = combined_data_2_cleaned_tbl, \n                             by    = \"patent_id\", \n                             all.x = TRUE, \n                             all.y = FALSE)\n\n\ncombined_data_3_cleaned_tbl <- combined_data_3_tbl %>%\n  select(patent_id, type, date, organization, mainclass_id)\n\n\nsaveRDS(combined_data_3_cleaned_tbl, \"patent_3_cleaned_data_tbl.rds\")\n\n\nassignee_pa_p_uspc_data <- readRDS(\"patent_3_cleaned_data_tbl.rds\")\n\nassignee_pa_p_uspc_data_tbl <- as.data.table(assignee_pa_p_uspc_data)\n\n\nclean_try <- assignee_pa_p_uspc_data[,year := lubridate::year(date)]\nsaveRDS(clean_try, \"patent_3_cleaned_data_with_year_tbl.rds\")\n```\n:::\n\n\n## Combination of the data\n\n::: {.cell hash='03_data_wrangling_cache/html/exercise-3_38b70c977fc5d59485c384ae1aa65f40'}\n\n```{.r .cell-code}\n#combination of assignee and patent_assignee datasets\nassignee_pa_data <- readRDS(\"patent_1_cleaned_data_tbl.rds\")\nassignee_pa_data_tbl <- as.data.table(assignee_pa_data)\nassignee_pa <- assignee_pa_data_tbl[, .(COUNT = uniqueN(patent_id)), by = organization][order(-COUNT)]\nassignee_pa_clean <- assignee_pa[-c(4)]\nassignment_1_result <- head(assignee_pa_clean, 10)\nview(assignment_1_result)\nsaveRDS(assignment_1_result, \"result_1.rds\")\n\n\n\n#combination of assignee, patent_assignee, patent, and uspc datasets\n\nassignee_pa_p_uspc_with_year_data <- readRDS(\"patent_3_cleaned_data_with_year_tbl.rds\")\nassignee_pa_p_uspc_data_with_year_tbl <- as.data.table(assignee_pa_p_uspc_with_year_data)\nglimpse(assignee_pa_p_uspc_data_with_year_tbl)\nassignee_pa_p_uspc_final_tbl <- assignee_pa_p_uspc_data_with_year_tbl[date >= \"2014-08-01 & <= 2014-08-31\", .(COUNT = uniqueN(patent_id)), by = organization][order(-COUNT)]\nassignee_pa_p_uspc_final_tbl\nassignee_pa_p_uspc_final_tbl_clean <- assignee_pa_p_uspc_final_tbl[-c(1)]\nassignment_2_result <- head(assignee_pa_p_uspc_final_tbl_clean, 10)\nassignment_2_result\nsaveRDS(assignment_2_result, \"result_2.rds\")\n\n\n\n#combination of assignee, patent_assignee, and uspc datasets\nassignee_pa_uspc_data <- readRDS(\"patent_2_cleaned_data_tbl.rds\")\nassignee_pa_uspc_data_tbl <- as.data.table(assignee_pa_uspc_data)\nglimpse(assignee_pa_uspc_data_tbl)\nassignee_pa_uspc_final_tbl <- assignee_pa_uspc_data_tbl[, .(COUNT = uniqueN(patent_id)), by = .(organization, type)][order(-COUNT)]\n\n\nassignee_pa_uspc_clean <- assignee_pa_uspc_final_tbl[-c(1)]\nassignment_3a_result <- head(assignee_pa_uspc_clean, 10)\nassignment_3a_result\nsaveRDS(assignment_3a_result, \"result_3_1.rds\")\n\n\nassignee_pa_uspc_final_3b_tbl <- assignee_pa_uspc_data_tbl[, .(COUNT = .N), by = type][order(-COUNT)]\nassignee_pa_uspc_3b_clean <- assignee_pa_uspc_final_3b_tbl[-c(3)]\nassignment_3b_result <- head(assignee_pa_uspc_3b_clean, 5)\nassignment_3b_result$patent_type <- c(\"US Company or Corporation\", \"Foreign Company or Corporation\", \"US  Federal Government\", \"US Individual\", \"Foreign Individual\")\nassignment_3b_result\nsaveRDS(assignment_3b_result, \"result_3_2.rds\")\n```\n:::\n\n## Results\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-2_ceefca18cdceb7554f5aaf3cea154e94'}\n\n```{.r .cell-code}\n#Question 1:\n#List the 10 US companies with the most assigned/granted patents\nresult_1<- readRDS(\"result_1.rds\")\nprint(result_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                                    organization COUNT\n#>  1: International Business Machines Corporation  7547\n#>  2:               Samsung Electronics Co., Ltd.  5835\n#>  3:                      Canon Kabushiki Kaisha  4099\n#>  4:                       Microsoft Corporation  3165\n#>  5:                                 Google Inc.  2668\n#>  6:                    Kabushiki Kaisha Toshiba  2656\n#>  7:                       QUALCOMM Incorporated  2597\n#>  8:                         LG Electronics Inc.  2459\n#>  9:                       Panasonic Corporation  2218\n#> 10:                                  Apple Inc.  2201\n```\n:::\n\n```{.r .cell-code}\n#Question 2:\n#List the top 10 companies with the most new granted patents for August 2014.\nresult_2 <- readRDS(\"result_2.rds\")\nprint(result_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                                    organization COUNT\n#>  1: International Business Machines Corporation  2649\n#>  2:               Samsung Electronics Co., Ltd.  1866\n#>  3:                      Canon Kabushiki Kaisha  1332\n#>  4:                            Sony Corporation  1103\n#>  5:                       Microsoft Corporation   935\n#>  6:                    Kabushiki Kaisha Toshiba   931\n#>  7:                       QUALCOMM Incorporated   917\n#>  8:                                 Google Inc.   894\n#>  9:                         LG Electronics Inc.   772\n#> 10:                                  Apple Inc.   665\n```\n:::\n\n```{.r .cell-code}\n#Question 3:\n#What is the most innovative tech sector? For the top 10 companies (worldwide) with the most patents\nresult_3_1 <- readRDS(\"result_3_1.rds\")\nprint(result_3_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                                    organization type COUNT\n#>  1: International Business Machines Corporation    2  5923\n#>  2:               Samsung Electronics Co., Ltd.    3  4269\n#>  3:                      Canon Kabushiki Kaisha    3  3265\n#>  4:                            Sony Corporation    3  2618\n#>  5:                       Microsoft Corporation    2  2234\n#>  6:                    Kabushiki Kaisha Toshiba    3  2156\n#>  7:                       QUALCOMM Incorporated    2  2082\n#>  8:                                 Google Inc.    2  1923\n#>  9:                         LG Electronics Inc.    3  1767\n#> 10:                       Panasonic Corporation    3  1735\n```\n:::\n\n```{.r .cell-code}\n#Top 5 USPTO tech main classes\nresult_3_2 <- readRDS(\"result_3_2.rds\")\nprint(result_3_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>    type  COUNT                    patent_type\n#> 1:    3 411349      US Company or Corporation\n#> 2:    2 381134 Foreign Company or Corporation\n#> 3:    6   2913         US  Federal Government\n#> 4:    4   2864                  US Individual\n#> 5:    5   2441             Foreign Individual\n```\n:::\n:::\n\n## Question 1\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-3_ab87bc9411df0d3e1ba0c2389c8a550c'}\n\n```{.r .cell-code}\n#Question 1:\n#List the 10 US companies with the most assigned/granted patents\nresult_1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNT\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"7547\"},{\"1\":\"Samsung Electronics Co., Ltd.\",\"2\":\"5835\"},{\"1\":\"Canon Kabushiki Kaisha\",\"2\":\"4099\"},{\"1\":\"Microsoft Corporation\",\"2\":\"3165\"},{\"1\":\"Google Inc.\",\"2\":\"2668\"},{\"1\":\"Kabushiki Kaisha Toshiba\",\"2\":\"2656\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"2597\"},{\"1\":\"LG Electronics Inc.\",\"2\":\"2459\"},{\"1\":\"Panasonic Corporation\",\"2\":\"2218\"},{\"1\":\"Apple Inc.\",\"2\":\"2201\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n## Question 2\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-4_da62067b0de5e1d781614fcd40129541'}\n\n```{.r .cell-code}\n#Question 2:\n#List the top 10 companies with the most new granted patents for August 2014.\nresult_2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNT\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"2649\"},{\"1\":\"Samsung Electronics Co., Ltd.\",\"2\":\"1866\"},{\"1\":\"Canon Kabushiki Kaisha\",\"2\":\"1332\"},{\"1\":\"Sony Corporation\",\"2\":\"1103\"},{\"1\":\"Microsoft Corporation\",\"2\":\"935\"},{\"1\":\"Kabushiki Kaisha Toshiba\",\"2\":\"931\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"917\"},{\"1\":\"Google Inc.\",\"2\":\"894\"},{\"1\":\"LG Electronics Inc.\",\"2\":\"772\"},{\"1\":\"Apple Inc.\",\"2\":\"665\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n## Question 3\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-5_8a2c7003d3d7c88300834374d93f1094'}\n\n```{.r .cell-code}\n#Question 3:\n#What is the most innovative tech sector? For the top 10 companies (worldwide) with the most patents\nresult_3_1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"type\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNT\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"2\",\"3\":\"5923\"},{\"1\":\"Samsung Electronics Co., Ltd.\",\"2\":\"3\",\"3\":\"4269\"},{\"1\":\"Canon Kabushiki Kaisha\",\"2\":\"3\",\"3\":\"3265\"},{\"1\":\"Sony Corporation\",\"2\":\"3\",\"3\":\"2618\"},{\"1\":\"Microsoft Corporation\",\"2\":\"2\",\"3\":\"2234\"},{\"1\":\"Kabushiki Kaisha Toshiba\",\"2\":\"3\",\"3\":\"2156\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"2\",\"3\":\"2082\"},{\"1\":\"Google Inc.\",\"2\":\"2\",\"3\":\"1923\"},{\"1\":\"LG Electronics Inc.\",\"2\":\"3\",\"3\":\"1767\"},{\"1\":\"Panasonic Corporation\",\"2\":\"3\",\"3\":\"1735\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n## Question 3 Part 2\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-6_512b5b3c0d73ec4772dddeebb2e07e8e'}\n\n```{.r .cell-code}\n#Top 5 USPTO tech main classes\nresult_3_2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"type\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNT\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"patent_type\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"3\",\"2\":\"411349\",\"3\":\"US Company or Corporation\"},{\"1\":\"2\",\"2\":\"381134\",\"3\":\"Foreign Company or Corporation\"},{\"1\":\"6\",\"2\":\"2913\",\"3\":\"US  Federal Government\"},{\"1\":\"4\",\"2\":\"2864\",\"3\":\"US Individual\"},{\"1\":\"5\",\"2\":\"2441\",\"3\":\"Foreign Individual\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}