{
  "hash": "7391f1e4114b18209974fe8b070158aa",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Corinna Boenke\"\n---\n\n\n# Challenge 3\n\n## Load librarys\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-1_b98ad99f23b102de6af5f8f3ac478770'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(eval = FALSE)\n\nlibrary(conflicted)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.2     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.1\n```\n:::\n\n```{.r .cell-code}\nlibrary(vroom)\nlibrary(data.table)\nlibrary(furrr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Lade nötiges Paket: future\n```\n:::\n\n```{.r .cell-code}\nlibrary(tictoc)\nlibrary(readxl)\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\nconflicts_prefer(vroom::col_character)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> [conflicted] Will prefer vroom::col_character over any other package.\n```\n:::\n\n```{.r .cell-code}\nconflicts_prefer(vroom::col_date)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> [conflicted] Will prefer vroom::col_date over any other package.\n```\n:::\n\n```{.r .cell-code}\nconflicts_prefer(vroom::col_double)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> [conflicted] Will prefer vroom::col_double over any other package.\n```\n:::\n:::\n\n## Get Data\n\n::: {.cell hash='03_data_wrangling_cache/html/exercise_35a4600a3572a9827156814bdb4bca79'}\n\n```{.r .cell-code}\nassignee_col_types <- list(\n  id = col_character(),\n  type = col_character(),\n  name_first = col_character(),\n  name_last = col_character(),\n  organization = col_character()\n)\n\nassignee_tbl <- vroom(\n  file       = \"assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = assignee_col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\nassignee_clean_tbl <- assignee_tbl %>%\n  as_tibble() %>%\n  rename(assignee_id = id) %>%\n  select(assignee_id, type, organization)\n\nsetDT(assignee_clean_tbl)\nclass(assignee_clean_tbl)\n\npatent_assignee_col_types <- list(\n  patent_id = col_character(),\n  assignee_id = col_character(),\n  location_id = col_character()\n)\n\npatent_assignee_tbl <- vroom(\n  file       = \"patent_assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = patent_assignee_col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\n\npatent_assignee_clean_tbl <- patent_assignee_tbl %>%\n  as_tibble() %>%\n  select(assignee_id, patent_id)\n\nsetDT(patent_assignee_clean_tbl)\nclass(patent_assignee_clean_tbl)\n\n\ncombined_data_1_tbl <- merge(x = patent_assignee_clean_tbl, y = assignee_clean_tbl, \n                             by    = \"assignee_id\", \n                             all.x = TRUE, \n                             all.y = FALSE)\n\n\ncombined_data_1_cleaned_tbl <- combined_data_1_tbl %>%\n  select(patent_id, type, organization)\n\nsaveRDS(combined_data_1_cleaned_tbl, \"patent_1_cleaned_data_tbl.rds\")\n\nuspc_col_types <- list(\n  uuid = col_character(),\n  patent_id = col_character(),\n  mainclass_id = col_character(),\n  subclass_id = col_character(),\n  sequence = col_character()\n)\n\n\nuspc_tbl <- vroom(\n  file       = \"uspc.tsv\", \n  delim      = \"\\t\", \n  col_types  = uspc_col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\n\nuspc_clean_tbl <- uspc_tbl %>%\n  as_tibble() %>%\n  select(patent_id, mainclass_id)\n\nsetDT(uspc_clean_tbl)\nclass(uspc_clean_tbl)\n\n\n\ncombined_data_2_tbl <- merge(x = uspc_clean_tbl, y = combined_data_1_cleaned_tbl, \n                             by    = \"patent_id\", \n                             all.x = TRUE, \n                             all.y = FALSE)\n\ncombined_data_2_cleaned_tbl <- combined_data_2_tbl %>%\n  select(patent_id, type, organization,mainclass_id)\n\nsaveRDS(combined_data_2_cleaned_tbl, \"patent_2_cleaned_data_tbl.rds\")\n\ncol_types <- list(\n  id = col_character(),\n  type = col_character(),\n  number = col_character(),\n  country = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  month = col_character(),\n  abstract = col_character(),\n  title = col_character(),\n  kind = col_character(),\n  num_claims = col_double(),\n  filename = col_character(),\n  withdrawn = col_double()\n)\n\npatent_tbl <- vroom(\n  file       = \"patent.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\npatent_clean_tbl <- patent_tbl %>%\n  as_tibble() %>%\n  rename(patent_id = id) %>%\n  select(patent_id, date)\n\nsetDT(patent_clean_tbl)\nclass(patent_clean_tbl)\n\n\ncombined_data_3_tbl <- merge(x = patent_clean_tbl, y = combined_data_2_cleaned_tbl, \n                             by    = \"patent_id\", \n                             all.x = TRUE, \n                             all.y = FALSE)\n\n\ncombined_data_3_cleaned_tbl <- combined_data_3_tbl %>%\n  select(patent_id, type, date, organization, mainclass_id)\n\n\nsaveRDS(combined_data_3_cleaned_tbl, \"patent_3_cleaned_data_tbl.rds\")\n\n\nassignee_pa_p_uspc_data <- readRDS(\"patent_3_cleaned_data_tbl.rds\")\n\nassignee_pa_p_uspc_data_tbl <- as.data.table(assignee_pa_p_uspc_data)\n\n\nclean_try <- assignee_pa_p_uspc_data[,year := lubridate::year(date)]\nsaveRDS(clean_try, \"patent_3_cleaned_data_with_year_tbl.rds\")\n```\n:::\n\n\n## Combination of the data\n\n::: {.cell hash='03_data_wrangling_cache/html/exercise-3_38b70c977fc5d59485c384ae1aa65f40'}\n\n```{.r .cell-code}\n#combination of assignee and patent_assignee datasets\nassignee_pa_data <- readRDS(\"patent_1_cleaned_data_tbl.rds\")\nassignee_pa_data_tbl <- as.data.table(assignee_pa_data)\nassignee_pa <- assignee_pa_data_tbl[, .(COUNT = uniqueN(patent_id)), by = organization][order(-COUNT)]\nassignee_pa_clean <- assignee_pa[-c(4)]\nassignment_1_result <- head(assignee_pa_clean, 10)\nview(assignment_1_result)\nsaveRDS(assignment_1_result, \"result_1.rds\")\n\n\n\n#combination of assignee, patent_assignee, patent, and uspc datasets\n\nassignee_pa_p_uspc_with_year_data <- readRDS(\"patent_3_cleaned_data_with_year_tbl.rds\")\nassignee_pa_p_uspc_data_with_year_tbl <- as.data.table(assignee_pa_p_uspc_with_year_data)\nglimpse(assignee_pa_p_uspc_data_with_year_tbl)\nassignee_pa_p_uspc_final_tbl <- assignee_pa_p_uspc_data_with_year_tbl[date >= \"2014-08-01 & <= 2014-08-31\", .(COUNT = uniqueN(patent_id)), by = organization][order(-COUNT)]\nassignee_pa_p_uspc_final_tbl\nassignee_pa_p_uspc_final_tbl_clean <- assignee_pa_p_uspc_final_tbl[-c(1)]\nassignment_2_result <- head(assignee_pa_p_uspc_final_tbl_clean, 10)\nassignment_2_result\nsaveRDS(assignment_2_result, \"result_2.rds\")\n\n\n\n#combination of assignee, patent_assignee, and uspc datasets\nassignee_pa_uspc_data <- readRDS(\"patent_2_cleaned_data_tbl.rds\")\nassignee_pa_uspc_data_tbl <- as.data.table(assignee_pa_uspc_data)\nglimpse(assignee_pa_uspc_data_tbl)\nassignee_pa_uspc_final_tbl <- assignee_pa_uspc_data_tbl[, .(COUNT = uniqueN(patent_id)), by = .(organization, type)][order(-COUNT)]\n\n\nassignee_pa_uspc_clean <- assignee_pa_uspc_final_tbl[-c(1)]\nassignment_3a_result <- head(assignee_pa_uspc_clean, 10)\nassignment_3a_result\nsaveRDS(assignment_3a_result, \"result_3_1.rds\")\n\n\nassignee_pa_uspc_final_3b_tbl <- assignee_pa_uspc_data_tbl[, .(COUNT = .N), by = type][order(-COUNT)]\nassignee_pa_uspc_3b_clean <- assignee_pa_uspc_final_3b_tbl[-c(3)]\nassignment_3b_result <- head(assignee_pa_uspc_3b_clean, 5)\nassignment_3b_result$patent_type <- c(\"US Company or Corporation\", \"Foreign Company or Corporation\", \"US  Federal Government\", \"US Individual\", \"Foreign Individual\")\nassignment_3b_result\nsaveRDS(assignment_3b_result, \"result_3_2.rds\")\n```\n:::\n\n## Results\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-2_4fc1c526928e6d4b83eee5db9678511f'}\n\n```{.r .cell-code}\n#Question 1:\n#List the 10 US companies with the most assigned/granted patents\nresult_1<- readRDS(\"result_1.rds\")\nprint(result_1)\n\n#Question 2:\n#List the top 10 companies with the most new granted patents for August 2014.\nresult_2 <- readRDS(\"result_2.rds\")\nprint(result_2)\n\n#Question 3:\n#What is the most innovative tech sector? For the top 10 companies (worldwide) with the most patents\nresult_3_1 <- readRDS(\"result_3_1.rds\")\nprint(result_3_1)\n\n#Top 5 USPTO tech main classes\nresult_3_2 <- readRDS(\"result_3_2.rds\")\nprint(result_3_2)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}