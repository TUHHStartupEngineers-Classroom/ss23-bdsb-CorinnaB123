{
  "hash": "a3e40114908d3a3c1e8c7cb554eb78f4",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Corinna Boenke\"\n---\n\n# Challenge 1\n\n## Load librarys\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_6ff099244eaac7a19563cd5124fb3d69'}\n\n```{.r .cell-code}\nlibrary(conflicted)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'dplyr' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyverse' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'ggplot2' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tibble' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyr' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'readr' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'purrr' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'stringr' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'forcats' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'lubridate' wurde unter R Version 4.2.3 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ forcats   1.0.0     ✔ readr     2.1.4\n#> ✔ ggplot2   3.4.2     ✔ stringr   1.5.0\n#> ✔ lubridate 1.9.2     ✔ tibble    3.2.1\n#> ✔ purrr     1.0.1     ✔ tidyr     1.3.0\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'readxl' wurde unter R Version 4.2.3 erstellt\n```\n:::\n:::\n\n## Import data\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_fc2993da249071bdf5a72e52e4bc5e80'}\n\n```{.r .cell-code}\nbikeshops_tbl <- read_excel(\"D:\\\\Corinna\\\\TUHH\\\\SoSe2023\\\\BusinessDataBasics\\\\ss23-bdsb-CorinnaB123\\\\Data\\\\bikeshops.xlsx\")\norderlines_tbl <- read_excel(\"D:\\\\Corinna\\\\TUHH\\\\SoSe2023\\\\BusinessDataBasics\\\\ss23-bdsb-CorinnaB123\\\\Data\\\\orderlines.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> New names:\n#> • `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nbikes_tbl  <- read_excel(\"D:\\\\Corinna\\\\TUHH\\\\SoSe2023\\\\BusinessDataBasics\\\\ss23-bdsb-CorinnaB123\\\\Data\\\\bikes.xlsx\")\n```\n:::\n\n## Joining data\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-3_3000aca5fe1bf35e62e3daa52a96e195'}\n\n```{.r .cell-code}\nbike_orderlines_joined_tbl <- orderlines_tbl %>%\n    left_join(bikes_tbl, by = c(\"product.id\" = \"bike.id\")) %>%\n    left_join(bikeshops_tbl, by = c(\"customer.id\" = \"bikeshop.id\"))\n```\n:::\n\n## Wrangling data\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-4_54f23e9a53e7a4d62cadf6be2abb3814'}\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl <- bike_orderlines_joined_tbl %>%\n  #separate\n  separate(col    = location,\n          into   = c(\"city\", \"state\"),\n          sep    = \", \") %>%\n  #Add the total price\n   mutate(total.price = price * quantity) %>%\n  #Rename\n  rename(bikeshop = name) %>%\n          set_names(names(.) %>% str_replace_all(\"\\\\.\", \"_\"))\n```\n:::\n\n## Business Insights\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-5_d9113e7cc6bebbf070597fe105b53ca1'}\n\n```{.r .cell-code}\n library(lubridate)\n#Manipulate\n sales_by_state_tbl <- bike_orderlines_wrangled_tbl %>%\n    # Select columns\n   select(state, total_price) %>%\n   # Grouping by state and summarizing sales\n   group_by(state) %>% \n        summarize(sales = sum(total_price)) %>%\n   #Add a column that turns the numbers into a currency format\n   mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n\n    sales_by_state_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"state\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sales\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sales_text\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Baden-Württemberg\",\"2\":\"6521090\",\"3\":\"6.521.090 €\"},{\"1\":\"Bavaria\",\"2\":\"6742819\",\"3\":\"6.742.819 €\"},{\"1\":\"Berlin\",\"2\":\"1128433\",\"3\":\"1.128.433 €\"},{\"1\":\"Bremen\",\"2\":\"10653499\",\"3\":\"10.653.499 €\"},{\"1\":\"Hamburg\",\"2\":\"3874756\",\"3\":\"3.874.756 €\"},{\"1\":\"Hesse\",\"2\":\"1558901\",\"3\":\"1.558.901 €\"},{\"1\":\"Lower Saxony\",\"2\":\"4107115\",\"3\":\"4.107.115 €\"},{\"1\":\"Mecklenburg-Western Pomerania\",\"2\":\"618974\",\"3\":\"618.974 €\"},{\"1\":\"North Rhine-Westphalia\",\"2\":\"21200613\",\"3\":\"21.200.613 €\"},{\"1\":\"Saxony\",\"2\":\"2230245\",\"3\":\"2.230.245 €\"},{\"1\":\"Saxony-Anhalt\",\"2\":\"569614\",\"3\":\"569.614 €\"},{\"1\":\"Schleswig-Holstein\",\"2\":\"3224749\",\"3\":\"3.224.749 €\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-6_f1a8f0955c151c58e7496f067a3f0493'}\n\n```{.r .cell-code}\n # Visualize the data\n        sales_by_state_tbl %>%\n          \n          # Setup canvas with the columns year (x-axis) and sales (y-axis)\n          ggplot(aes(x = state, y = sales)) +\n          \n          \n          # Geometries\n          geom_col(fill = \"#2DC6D6\") + \n          geom_label(aes(label = sales_text)) +\n          \n          # Hint\n          theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n          theme(axis.text.y = element_text(angle = 45, hjust = 1)) +\n          \n          # Formatting\n          scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                            decimal.mark = \",\", \n                                                            prefix = \"\", \n                                                            suffix = \" €\")) +\n          labs(\n            title    = \"Revenue by state\",\n            x = \"States\",\n            y = \"Revenue\"\n          )\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-7_903937db472fbc3dcf115c8b72a60aaa'}\n\n```{.r .cell-code}\n # Sales by State and Year ----\n\n      # Manipulate\n\n          sales_by_state_year_tbl <- bike_orderlines_wrangled_tbl %>%\n  \n      # Select columns and add the a year\n          select(order_date, total_price, state) %>%\n          mutate(year = year(order_date)) %>%\n  \n      # Group by and summarize year and state\n          group_by(year, state) %>%\n          summarise(sales = sum(total_price)) %>%\n          ungroup() %>%\n  \n      # Format\n          mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'year'. You can override using the\n#> `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nsales_by_state_year_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"state\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sales\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sales_text\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2015\",\"2\":\"Baden-Württemberg\",\"3\":\"1031924\",\"4\":\"1.031.924 €\"},{\"1\":\"2015\",\"2\":\"Bavaria\",\"3\":\"1301461\",\"4\":\"1.301.461 €\"},{\"1\":\"2015\",\"2\":\"Berlin\",\"3\":\"95853\",\"4\":\"95.853 €\"},{\"1\":\"2015\",\"2\":\"Bremen\",\"3\":\"1395912\",\"4\":\"1.395.912 €\"},{\"1\":\"2015\",\"2\":\"Hamburg\",\"3\":\"423090\",\"4\":\"423.090 €\"},{\"1\":\"2015\",\"2\":\"Hesse\",\"3\":\"308609\",\"4\":\"308.609 €\"},{\"1\":\"2015\",\"2\":\"Lower Saxony\",\"3\":\"584386\",\"4\":\"584.386 €\"},{\"1\":\"2015\",\"2\":\"Mecklenburg-Western Pomerania\",\"3\":\"222003\",\"4\":\"222.003 €\"},{\"1\":\"2015\",\"2\":\"North Rhine-Westphalia\",\"3\":\"3735092\",\"4\":\"3.735.092 €\"},{\"1\":\"2015\",\"2\":\"Saxony\",\"3\":\"238371\",\"4\":\"238.371 €\"},{\"1\":\"2015\",\"2\":\"Saxony-Anhalt\",\"3\":\"144737\",\"4\":\"144.737 €\"},{\"1\":\"2015\",\"2\":\"Schleswig-Holstein\",\"3\":\"448844\",\"4\":\"448.844 €\"},{\"1\":\"2016\",\"2\":\"Baden-Württemberg\",\"3\":\"1561658\",\"4\":\"1.561.658 €\"},{\"1\":\"2016\",\"2\":\"Bavaria\",\"3\":\"1129852\",\"4\":\"1.129.852 €\"},{\"1\":\"2016\",\"2\":\"Berlin\",\"3\":\"72361\",\"4\":\"72.361 €\"},{\"1\":\"2016\",\"2\":\"Bremen\",\"3\":\"2057760\",\"4\":\"2.057.760 €\"},{\"1\":\"2016\",\"2\":\"Hamburg\",\"3\":\"636550\",\"4\":\"636.550 €\"},{\"1\":\"2016\",\"2\":\"Hesse\",\"3\":\"225647\",\"4\":\"225.647 €\"},{\"1\":\"2016\",\"2\":\"Lower Saxony\",\"3\":\"639839\",\"4\":\"639.839 €\"},{\"1\":\"2016\",\"2\":\"Mecklenburg-Western Pomerania\",\"3\":\"75443\",\"4\":\"75.443 €\"},{\"1\":\"2016\",\"2\":\"North Rhine-Westphalia\",\"3\":\"3002792\",\"4\":\"3.002.792 €\"},{\"1\":\"2016\",\"2\":\"Saxony\",\"3\":\"589994\",\"4\":\"589.994 €\"},{\"1\":\"2016\",\"2\":\"Saxony-Anhalt\",\"3\":\"65901\",\"4\":\"65.901 €\"},{\"1\":\"2016\",\"2\":\"Schleswig-Holstein\",\"3\":\"672710\",\"4\":\"672.710 €\"},{\"1\":\"2017\",\"2\":\"Baden-Württemberg\",\"3\":\"1224152\",\"4\":\"1.224.152 €\"},{\"1\":\"2017\",\"2\":\"Bavaria\",\"3\":\"1411851\",\"4\":\"1.411.851 €\"},{\"1\":\"2017\",\"2\":\"Berlin\",\"3\":\"451293\",\"4\":\"451.293 €\"},{\"1\":\"2017\",\"2\":\"Bremen\",\"3\":\"2557145\",\"4\":\"2.557.145 €\"},{\"1\":\"2017\",\"2\":\"Hamburg\",\"3\":\"731678\",\"4\":\"731.678 €\"},{\"1\":\"2017\",\"2\":\"Hesse\",\"3\":\"338783\",\"4\":\"338.783 €\"},{\"1\":\"2017\",\"2\":\"Lower Saxony\",\"3\":\"1055747\",\"4\":\"1.055.747 €\"},{\"1\":\"2017\",\"2\":\"Mecklenburg-Western Pomerania\",\"3\":\"201218\",\"4\":\"201.218 €\"},{\"1\":\"2017\",\"2\":\"North Rhine-Westphalia\",\"3\":\"4671541\",\"4\":\"4.671.541 €\"},{\"1\":\"2017\",\"2\":\"Saxony\",\"3\":\"595378\",\"4\":\"595.378 €\"},{\"1\":\"2017\",\"2\":\"Saxony-Anhalt\",\"3\":\"194509\",\"4\":\"194.509 €\"},{\"1\":\"2017\",\"2\":\"Schleswig-Holstein\",\"3\":\"1076996\",\"4\":\"1.076.996 €\"},{\"1\":\"2018\",\"2\":\"Baden-Württemberg\",\"3\":\"1114327\",\"4\":\"1.114.327 €\"},{\"1\":\"2018\",\"2\":\"Bavaria\",\"3\":\"1168783\",\"4\":\"1.168.783 €\"},{\"1\":\"2018\",\"2\":\"Berlin\",\"3\":\"318974\",\"4\":\"318.974 €\"},{\"1\":\"2018\",\"2\":\"Bremen\",\"3\":\"1833844\",\"4\":\"1.833.844 €\"},{\"1\":\"2018\",\"2\":\"Hamburg\",\"3\":\"930803\",\"4\":\"930.803 €\"},{\"1\":\"2018\",\"2\":\"Hesse\",\"3\":\"330647\",\"4\":\"330.647 €\"},{\"1\":\"2018\",\"2\":\"Lower Saxony\",\"3\":\"929624\",\"4\":\"929.624 €\"},{\"1\":\"2018\",\"2\":\"Mecklenburg-Western Pomerania\",\"3\":\"21041\",\"4\":\"21.041 €\"},{\"1\":\"2018\",\"2\":\"North Rhine-Westphalia\",\"3\":\"4601681\",\"4\":\"4.601.681 €\"},{\"1\":\"2018\",\"2\":\"Saxony\",\"3\":\"338344\",\"4\":\"338.344 €\"},{\"1\":\"2018\",\"2\":\"Saxony-Anhalt\",\"3\":\"81163\",\"4\":\"81.163 €\"},{\"1\":\"2018\",\"2\":\"Schleswig-Holstein\",\"3\":\"572622\",\"4\":\"572.622 €\"},{\"1\":\"2019\",\"2\":\"Baden-Württemberg\",\"3\":\"1589029\",\"4\":\"1.589.029 €\"},{\"1\":\"2019\",\"2\":\"Bavaria\",\"3\":\"1730872\",\"4\":\"1.730.872 €\"},{\"1\":\"2019\",\"2\":\"Berlin\",\"3\":\"189952\",\"4\":\"189.952 €\"},{\"1\":\"2019\",\"2\":\"Bremen\",\"3\":\"2808838\",\"4\":\"2.808.838 €\"},{\"1\":\"2019\",\"2\":\"Hamburg\",\"3\":\"1152635\",\"4\":\"1.152.635 €\"},{\"1\":\"2019\",\"2\":\"Hesse\",\"3\":\"355215\",\"4\":\"355.215 €\"},{\"1\":\"2019\",\"2\":\"Lower Saxony\",\"3\":\"897519\",\"4\":\"897.519 €\"},{\"1\":\"2019\",\"2\":\"Mecklenburg-Western Pomerania\",\"3\":\"99269\",\"4\":\"99.269 €\"},{\"1\":\"2019\",\"2\":\"North Rhine-Westphalia\",\"3\":\"5189507\",\"4\":\"5.189.507 €\"},{\"1\":\"2019\",\"2\":\"Saxony\",\"3\":\"468158\",\"4\":\"468.158 €\"},{\"1\":\"2019\",\"2\":\"Saxony-Anhalt\",\"3\":\"83304\",\"4\":\"83.304 €\"},{\"1\":\"2019\",\"2\":\"Schleswig-Holstein\",\"3\":\"453577\",\"4\":\"453.577 €\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-8_db676baedea9ff912f959a3e466a0658'}\n\n```{.r .cell-code}\n # Visualize the data\n          sales_by_state_year_tbl %>%\n  \n        # Set up x, y, fill\n          ggplot(aes(x = year, y = sales, fill = state)) +\n  \n        # Geometries\n          geom_col() + \n  \n        # Facet\n          facet_wrap(~ state) +\n  \n        # Formatting\n          scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n          labs(\n                title = \"Revenue by state and year\",\n                fill = \"States\"\n              )\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}